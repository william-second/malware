
How to hook file activities in userspace, Windows
https://www.codeproject.com/Articles/30537/Windows-File-Monitoring-System-Using-Windows-API-H
https://www.codeproject.com/Articles/2082/API-hooking-revealed
http://vinsula.com/security-blog/
https://unlmtd.wordpress.com/2007/07/29/hooking-nt-functions/
----------------------------
Question 1: what is Service table 
2. How many injecting techniques
3. 

Design of an API spying framework 

Consists of at least 2 parts: a hook server and a driver. The hook server is responsible for injecting the driver into
targeted processes at the appropriate moment. 
- what applications do we need to hook 
- which implanting technique to follow
- which interception mechanism to use 

1. Injecting technique 
in order to inject a DLL into processes that link with USER32.DLL, we can jst add dll name to the value of the following 
registry 
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_DLLs
How it works, USER32 reads the value of mentioned registry key, and call LoadLibrary() for these DLLs in its DllMain code. 
Here is the diadvantage of this approach 
- to activate/deactivate the injection process we have to reboot Windows 
- DLL we want to inject will be mapped to only processes that use USER32.DLL ===> canot inject into console application since 
it does not import functions from USER32.dll 
- dont have the control over the injection process. It is implanted to every single GUI application ==> huge amount of redundance 

2. System wide windows hooks
- use what provided by Windows Hooks 
- hook callback procedure is executed in the address spaces of each hooked up process in the system. 
- call SetWindowsHookEx() with the appropriated parameters
- after SetWinowsHookEx() is executed, the system injects the DLL automatically into all proesses that meet 
the requirements for this particular hook filter. 
---------------------

Hooking NtCreatSection():
- similar to other stub from ntdll.dll, NtCreatSection() load EAX with the service index, makes EDX point to function parameters, 
and transfers execution to KisDispatchService() kernel-mode routin ( int 0x2e instruciton under Windows Nt/2000). After validating 
function parameters, KisDispatchService() transfer execution to the actual implementation of the service, the address of which is 
available from the Service Descriptor Table ( pointer to this table is exported by ntoskrn.exe
- All we have to do to hook any native API function on system-wide basis is to write the address of our proxy function to the 
i-th entry of the array, pointed to by ServiceTable field of 
